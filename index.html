<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="description" content="lifePAD - Primary Artistry Device. An Excalidraw alternative with hand-drawn diagrams, shapes, text, and artistic brushes. Privacy-first PWA.">
    <meta name="theme-color" content="#2c2c2c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="lifePAD">
    <title>lifePAD</title>
    <link rel="manifest" href="manifest.webmanifest">
    <link rel="icon" type="image/png" href="icons/lifepad.PNG">
    <link rel="apple-touch-icon" href="icons/lifepad.PNG">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Intro Overlay -->
    <div id="intro-overlay" class="intro-overlay">
        <div class="intro-content">
            <div class="intro-header">
                <img src="icons/lifepad.PNG" alt="lifePAD Logo" class="intro-logo">
                <h1>lifePAD</h1>
                <p class="subtitle">Primary Artistry Device</p>
            </div>
            
            <div class="intro-sections">
                <section>
                    <h2>What it is</h2>
                    <p>A sketch pad and diagramming tool with encryption, shapes, text, and artistic brushes. An alternative to a web based design tool that works with touch and stylus on any device.</p>
                </section>
                
                <section>
                    <h2>What you can do</h2>
                    <p>Create diagrams and drawings with hand-drawn style shapes, add text labels, use different brush textures, and export as PNG or SVG. Real-time collaboration included.</p>
                </section>
                
                <section>
                    <h2>Privacy</h2>
                    <p>Everything stays on your device. No accounts needed. No data sent anywhere unless you authorize it. Works completely offline.</p>
                </section>
            </div>
            
            <div class="intro-actions">
                <button id="start-drawing" class="primary-btn">Start drawing</button>
                <button id="sample-canvas" class="secondary-btn">Open sample canvas</button>
                <label class="checkbox-label">
                    <input type="checkbox" id="dont-show-again">
                    <span>Do not show again</span>
                </label>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="app">
        <!-- Top Navbar -->
        <nav class="navbar">
            <div class="nav-section colors-section">
                <label>Colors:</label>
                <div class="color-swatches">
                    <button class="color-swatch active" data-color="#000000" style="background: #000000;" title="Black"></button>
                    <button class="color-swatch" data-color="#ff4444" style="background: #ff4444;" title="Red"></button>
                    <button class="color-swatch" data-color="#4488ff" style="background: #4488ff;" title="Blue"></button>
                    <button class="color-swatch" data-color="#44cc44" style="background: #44cc44;" title="Green"></button>
                    <button class="color-swatch" data-color="#ffcc44" style="background: #ffcc44;" title="Yellow"></button>
                    <button class="color-swatch" data-color="#ff8844" style="background: #ff8844;" title="Orange"></button>
                    <button class="color-swatch" data-color="#cc44cc" style="background: #cc44cc;" title="Purple"></button>
                    <button class="color-swatch" data-color="#ffffff" style="background: #ffffff; border: 1px solid #ccc;" title="White"></button>
                    <input type="color" id="custom-color" value="#000000" title="Custom color">
                </div>
            </div>

            <div class="nav-section">
                <label for="pen-size">Size:</label>
                <input type="range" id="pen-size" min="1" max="48" value="4" step="1">
                <span id="pen-size-value">4</span>
            </div>

            <div class="nav-section">
                <label for="brush-texture">Texture:</label>
                <select id="brush-texture">
                    <option value="ink">Ink</option>
                    <option value="pencil">Pencil</option>
                    <option value="marker">Marker</option>
                    <option value="spray">Spray</option>
                    <option value="charcoal">Charcoal</option>
                </select>
            </div>

            <div class="nav-section actions-section">
                <button id="select-tool" class="tool-btn" title="Select and move objects">Select</button>
                <button id="text-tool" class="tool-btn" title="Add text">Text</button>
                <button id="brush-eraser-toggle" class="tool-btn active" title="Toggle Brush/Eraser">Brush</button>
                <button id="undo-btn" class="tool-btn" title="Undo">Undo</button>
                <button id="redo-btn" class="tool-btn" title="Redo">Redo</button>
                <button id="clear-btn" class="tool-btn" title="Clear canvas">Clear</button>
                <button id="save-btn" class="tool-btn primary" title="Save as PNG">Save PNG</button>
                <div class="tools-dropdown">
                    <button id="tools-btn" class="tool-btn" title="Tools">Tools ▼</button>
                    <div id="tools-menu" class="dropdown-menu">
                        <button id="shapes-btn" class="dropdown-item">Shapes</button>
                        <button id="ruler-btn" class="dropdown-item">Ruler</button>
                        <button id="export-svg-btn" class="dropdown-item">Export SVG</button>
                    </div>
                </div>
                <button id="help-btn" class="tool-btn" title="Help">Help</button>
                <button id="install-btn" class="tool-btn" title="Install app" style="display: none;">Install</button>
            </div>

            <div class="nav-section collab-status-section">
                <button id="collab-btn" class="tool-btn" title="Collaboration">Collab</button>
                <span id="collab-status" class="collab-status">Disconnected</span>
                <span id="tool-status" class="tool-status">Tool: Brush</span>
            </div>

            <div class="nav-section settings-section">
                <button id="theme-toggle" class="tool-btn" title="Toggle theme">Theme</button>
                <label class="checkbox-label small">
                    <input type="checkbox" id="paper-bg">
                    <span>Paper</span>
                </label>
            </div>
            
            <div class="nav-section zoom-section">
                <button id="zoom-out-btn" class="tool-btn" title="Zoom out (Ctrl/Cmd -)">-</button>
                <span id="zoom-level">100%</span>
                <button id="zoom-in-btn" class="tool-btn" title="Zoom in (Ctrl/Cmd +)">+</button>
                <button id="zoom-reset-btn" class="tool-btn" title="Reset zoom (Ctrl/Cmd 0)">Reset</button>
            </div>
        </nav>

        <!-- Canvas Container -->
        <div id="canvas-container">
            <canvas id="drawing-canvas"></canvas>
            <canvas id="overlay-canvas"></canvas>
            <!-- Shapes Panel -->
            <div id="shapes-panel" class="shapes-panel hidden">
                <div class="panel-header">
                    <h3>Shapes</h3>
                    <button id="close-shapes" class="close-btn">✕</button>
                </div>
                <div class="shapes-grid">
                    <button class="shape-btn" data-shape="rectangle" title="Rectangle">▭</button>
                    <button class="shape-btn" data-shape="circle" title="Circle">○</button>
                    <button class="shape-btn" data-shape="line" title="Line">/</button>
                    <button class="shape-btn" data-shape="triangle" title="Triangle">△</button>
                    <button class="shape-btn" data-shape="arrow" title="Arrow">→</button>
                    <button class="shape-btn" data-shape="star" title="Star">★</button>
                    <button class="shape-btn" data-shape="diamond" title="Diamond">◇</button>
                    <button class="shape-btn" data-shape="ellipse" title="Ellipse">⬭</button>
                </div>
                <div class="shape-controls">
                    <label>
                        <input type="checkbox" id="shape-fill" />
                        <span>Fill shape</span>
                    </label>
                    <label>
                        <input type="checkbox" id="shape-rough" />
                        <span>Hand-drawn style</span>
                    </label>
                </div>
            </div>
            <!-- Ruler Overlay -->
            <div id="ruler-overlay" class="ruler-overlay hidden">
                <div class="ruler-container">
                    <div class="ruler horizontal-ruler" id="horizontal-ruler">
                        <div class="ruler-measurements"></div>
                    </div>
                    <div class="ruler vertical-ruler" id="vertical-ruler">
                        <div class="ruler-measurements"></div>
                    </div>
                </div>
                <div class="ruler-controls">
                    <div class="ruler-control-group">
                        <label for="ruler-scale">Scale (pixels per meter):</label>
                        <input type="range" id="ruler-scale" min="50" max="200" value="100" step="10">
                        <span id="ruler-scale-value">100</span>
                    </div>
                    <button id="ruler-reset" class="secondary-btn">Reset Position</button>
                </div>
                <button id="close-ruler" class="close-ruler-btn">Close Ruler</button>
            </div>
        </div>
    </div>

    <!-- Text Input Dialog -->
    <div id="text-dialog" class="text-dialog hidden">
        <div class="text-dialog-content">
            <textarea id="text-input" placeholder="Enter text..." rows="4"></textarea>
            <div class="text-dialog-actions">
                <button id="text-confirm" class="primary-btn">Add Text</button>
                <button id="text-cancel" class="secondary-btn">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- Collaboration Modal -->
    <div id="collab-modal" class="modal-overlay hidden">
        <div class="modal-content collab-modal">
            <div class="modal-header">
                <h2>Collaboration</h2>
                <button id="close-collab-modal" class="close-btn" title="Close">&times;</button>
            </div>
            
            <div class="modal-tabs">
                <button class="tab-btn active" data-tab="host">Host Session</button>
                <button class="tab-btn" data-tab="join">Join Session</button>
            </div>
            
            <div class="modal-body">
                <!-- Host Tab -->
                <div id="host-tab" class="tab-content active">
                    <div class="info-box">
                        <p><strong>How to host:</strong></p>
                        <ol>
                            <li>Enter a session passphrase (shared with peer)</li>
                            <li>Click "Create offer" and wait for the offer blob</li>
                            <li>Copy the offer blob and send it to the joiner (via chat, email, etc.)</li>
                            <li>Paste the answer blob from the joiner below</li>
                            <li>Click "Apply answer" to establish connection</li>
                        </ol>
                    </div>
                    
                    <div class="form-group">
                        <label for="host-passphrase">Session Passphrase:</label>
                        <input type="password" id="host-passphrase" placeholder="Enter a strong passphrase" autocomplete="off">
                    </div>
                    
                    <button id="create-offer-btn" class="primary-btn">Create Offer</button>
                    
                    <div id="offer-output" class="output-section hidden">
                        <label>Offer Blob (send to joiner):</label>
                        <textarea id="offer-blob" readonly rows="6"></textarea>
                        <button id="copy-offer-btn" class="secondary-btn">Copy Offer</button>
                    </div>
                    
                    <div id="answer-input" class="input-section hidden">
                        <div class="form-group">
                            <label for="answer-blob-input">Answer Blob (from joiner):</label>
                            <textarea id="answer-blob-input" placeholder="Paste answer blob here" rows="6"></textarea>
                        </div>
                        <button id="apply-answer-btn" class="primary-btn">Apply Answer</button>
                    </div>
                </div>
                
                <!-- Join Tab -->
                <div id="join-tab" class="tab-content">
                    <div class="info-box">
                        <p><strong>How to join:</strong></p>
                        <ol>
                            <li>Enter the same passphrase as the host</li>
                            <li>Paste the offer blob from the host</li>
                            <li>Click "Create answer" and wait</li>
                            <li>Copy the answer blob and send it back to the host</li>
                                                        <li>The host can cancel the connection at any time</li>
                            <li>Wait for host to apply answer - connection will establish - begin your session</li>
                        </ol>
                    </div>
                    
                    <div class="form-group">
                        <label for="join-passphrase">Session Passphrase:</label>
                        <input type="password" id="join-passphrase" placeholder="Same passphrase as host" autocomplete="off">
                    </div>
                    
                    <div class="form-group">
                        <label for="offer-blob-input">Offer Blob (from host):</label>
                        <textarea id="offer-blob-input" placeholder="Paste offer blob here" rows="6"></textarea>
                    </div>
                    
                    <button id="create-answer-btn" class="primary-btn">Create Answer</button>
                    
                    <div id="answer-output" class="output-section hidden">
                        <label>Answer Blob (send to host):</label>
                        <textarea id="answer-blob" readonly rows="6"></textarea>
                        <button id="copy-answer-btn" class="secondary-btn">Copy Answer</button>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button id="disconnect-btn" class="secondary-btn hidden">Disconnect</button>
                <div id="collab-error" class="error-message hidden"></div>
            </div>
        </div>
    </div>

    <!-- iOS Install Help Modal -->
    <div id="ios-install-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Install on iOS</h2>
                <button id="close-ios-install" class="close-btn" title="Close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="info-box">
                    <p><strong>To install lifePAD on your iOS device:</strong></p>
                    <ol>
                        <li>Tap the Share button at the bottom of Safari (square with arrow pointing up)</li>
                        <li>Scroll down and tap "Add to Home Screen"</li>
                        <li>Tap "Add" in the top right corner</li>
                        <li>lifePAD will appear on your home screen like a native app</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
